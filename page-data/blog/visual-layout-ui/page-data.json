{"componentChunkName":"component---src-templates-blog-detail-js","path":"/blog/visual-layout-ui","result":{"data":{"mdx":{"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"slug\": \"/blog/visual-layout-ui\",\n  \"title\": \"可视化拖拽（小程序）布局编辑器\",\n  \"date\": \"2022-04-05 15:52:30\",\n  \"brief\": \"PC端的布局比较复杂，拖拽布局实现起来复杂度和难度都较高，目前暂时只考虑小程序的，等今后遇到PC端的实际项目需求再继续深究。本篇基于vue实现了比较简易的可视化拖拽（小程序）布局编辑器。\",\n  \"tag\": \"vue\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", null, \"\\u9700\\u6C42\\u80CC\\u666F\"), mdx(\"p\", null, \"\\u7F51\\u4E0A\\u6709\\u8BB8\\u591A\\u7C7B\\u4F3C\\u53EF\\u89C6\\u5316\\u62D6\\u62FD\\u5E03\\u5C40\\u7684\\u4E1A\\u52A1\\u9700\\u6C42\\uFF0C\\u6211\\u4E00\\u76F4\\u4EE5\\u6765\\u4E5F\\u90FD\\u6709\\u5173\\u6CE8\\uFF0C\\u4F46\\u5BF9\\u4E8E\\u5176\\u4E2D\\u7684\\u4E00\\u4E9B\\u7EC6\\u8282\\u8FD8\\u6709\\u4E9B\\u7591\\u60D1\\u3002\\u76F4\\u5230\\u770B\\u5230\\u4E86 \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://juejin.cn/post/6924156555617271821\"\n  }, \"\\u300A\\u624B\\u628A\\u624B\\u5E26\\u4F60\\u5199 Vue \\u53EF\\u89C6\\u5316\\u62D6\\u62FD\\u9875\\u9762\\u7F16\\u8F91\\u5668\\u300B\"), \" \\u8FD9\\u7BC7\\u6587\\u7AE0\\uFF0C\\u901A\\u8FC7\\u4F5C\\u8005\\u7EC6\\u81F4\\u7684\\u8BB2\\u89E3\\uFF0C\\u7EC8\\u4E8E\\u660E\\u767D\\u4E86\\u5B9E\\u73B0\\u601D\\u8DEF\\u3002\"), mdx(\"h3\", null, \"\\u5B9E\\u73B0\\u6548\\u679C\"), mdx(\"h4\", null, \"\\u9759\\u6001\\u6548\\u679C\\u56FE\"), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"/images/visual-layout-ui.png\",\n    \"alt\": \"静态效果图\"\n  })), mdx(\"h4\", null, \"\\u52A8\\u6001\\u6548\\u679C\\u56FE\"), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"/images/visual-layout-ui.gif\",\n    \"alt\": \"动态效果图\"\n  })), mdx(\"h3\", null, \"\\u5B9E\\u73B0\\u601D\\u8DEF\"), mdx(\"h4\", null, \"\\u62D6\\u62FD\\u884C\\u4E3A\"), mdx(\"p\", null, \"\\u7ED9\\u5143\\u7D20\\u8BBE\\u7F6E \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"draggable\"), \" \\u4E3A \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"true\"), \" \\uFF0C\\u4F7F\\u5F97\\u5B83\\u80FD\\u591F\\u88AB\\u62D6\\u62FD\\uFF1B\"), mdx(\"p\", null, \"\\u4F7F\\u7528\\u81EA\\u5B9A\\u4E49\\u5C5E\\u6027 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"data-type\"), \" \\u6765\\u6807\\u8BC6\\u88AB\\u62D6\\u62FD\\u7684\\u5143\\u7D20\\u8981\\u5BF9\\u5E94\\u653E\\u5165\\u7684\\u7EC4\\u4EF6\\u7C7B\\u578B\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-vue\"\n  }, \"<template>\\n  <ul\\n    class=\\\"component-list clearfix\\\"\\n    @dragstart=\\\"onDragStart\\\"\\n    @dragend=\\\"onDragEnd\\\"\\n  >\\n    <li\\n      class=\\\"component-item\\\"\\n      v-for=\\\"item in componentList\\\"\\n      :key=\\\"item.type\\\"\\n      :draggable=\\\"true\\\"\\n      :data-type=\\\"item.type\\\"\\n    >\\n      <i :class=\\\"['component-item__icon', 'icon-' + item.icon]\\\"></i>\\n      <span class=\\\"component-item__title\\\">{{ item.title }}</span>\\n    </li>\\n  </ul>\\n</template>\\n\")), mdx(\"h4\", null, \"\\u62D6\\u62FD\\u8FC7\\u7A0B\\u5904\\u7406\"), mdx(\"p\", null, \"\\u5728\\u62D6\\u62FD\\u4E8B\\u4EF6 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"dragover\"), \" \\u548C \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"drop\"), \" \\u4E2D\\u6DFB\\u52A0 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"e.preventDefault()\"), \" \\u8BA9\\u5143\\u7D20\\u80FD\\u591F\\u91CD\\u53E0\\u5728\\u76EE\\u6807\\u5BB9\\u5668\\u4E0A\\u65B9\\u3002\"), mdx(\"p\", null, \"\\u6DFB\\u52A0 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \" e.stopPropagation()\"), \" \\uFF0C\\u6B64\\u5904\\u6CA1\\u5FC5\\u8981\\u5192\\u6CE1\\u3002\"), mdx(\"p\", null, \"\\u8FD8\\u9700\\u8981\\u8BB0\\u5F55\\u51E0\\u4E2A\\u72B6\\u6001\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u5F53\\u524D\\u662F\\u5426\\u5904\\u4E8E\\u62D6\\u62FD\\u72B6\\u6001 \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"isDragging\"), \" \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u5F53\\u524D\\u62D6\\u62FD\\u7684\\u5143\\u7D20\\u5BF9\\u5E94\\u7684\\u7EC4\\u4EF6\\u7C7B\\u578B \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"draggingViewType\"), \" \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u662F\\u5426\\u5DF2\\u7ECF\\u5728\\u9884\\u89C8\\u89C6\\u56FE\\u4E2D\\u653E\\u5165\\u4E86\\u6B64\\u6B21\\u62D6\\u62FD\\u5BF9\\u5E94\\u7684\\u7EC4\\u4EF6 \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"hasPush\"), \" \")), mdx(\"h5\", null, \"\\u5F00\\u59CB\\u62D6\\u62FD \", mdx(\"inlineCode\", {\n    parentName: \"h5\"\n  }, \"dragstart\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"isDragging\"), \" -> true\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"draggingViewType\"), \" -> \\u88AB\\u62D6\\u62FD\\u5143\\u7D20\\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"data-type\"), \" \")), mdx(\"h5\", null, \"\\u62D6\\u62FD\\u8FC7\\u7A0B\\u4E2D \", mdx(\"inlineCode\", {\n    parentName: \"h5\"\n  }, \"dragover\")), mdx(\"p\", null, \"\\u4E00\\u65E6\\u62D6\\u62FD\\u5143\\u7D20\\u8FDB\\u5165\\u76EE\\u6807\\u5BB9\\u5668\\uFF0C\\u5C31\\u8981\\u5411\\u76EE\\u6807\\u5BB9\\u5668\\u4E2D\\u6DFB\\u52A0\\u5BF9\\u5E94\\u7684\\u7EC4\\u4EF6\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"const className =\\n      e.target.className !== 'view-content' ? 'item' : 'view-content'\\nlet defaultData\\nif (!hasPush.value) {\\n  const { data, options } = componentList[draggingViewType.value]\\n  defaultData = {\\n    type: draggingViewType.value,\\n    status: 2, // 2=\\u6E32\\u67D3\\u6210\\u5360\\u4F4D\\u7EC4\\u4EF6\\uFF0C1=\\u6E32\\u67D3\\u6210\\u5BF9\\u5E94\\u7684\\u89C6\\u56FE\\u7EC4\\u4EF6\\n    id: Date.now(),\\n    data: data ? JSON.parse(JSON.stringify(data)) : [],\\n    options: options ? JSON.parse(JSON.stringify(options)) : {},\\n  }\\n}\\n\")), mdx(\"p\", null, \"\\u6DFB\\u52A0\\u7684\\u4F4D\\u7F6E\\u662F\\u4E2A\\u95EE\\u9898\\uFF0C\\u9700\\u8981\\u5904\\u7406\\u3002\"), mdx(\"p\", null, \"\\u5982\\u679C\\u89C6\\u56FE\\u5BB9\\u5668\\u4E2D\\u5C1A\\u672A\\u6DFB\\u52A0\\u5BF9\\u5E94\\u7EC4\\u4EF6\\uFF0C\\u4E14\\u9700\\u8981\\u653E\\u5165\\u7684\\u4F4D\\u7F6E\\u662F\\u5916\\u5C42\\u89C6\\u56FE\\u5BB9\\u5668\\u7684\\u7A7A\\u767D\\u533A\\u57DF\\uFF0C\\u65E0\\u5176\\u4ED6\\u7EC4\\u4EF6\\uFF0C\\u90A3\\u4E48\\u53EF\\u4EE5\\u76F4\\u63A5\\u91CA\\u653E\\uFF1B\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"if (className === 'view-content') {\\n  if (!hasPush.value) {\\n    draggingViewIndex.value = views.value.length\\n    hasPush.value = true\\n    views.value.push(defaultData)\\n  }\\n} else {\\n  // ...\\n}\\n\")), mdx(\"p\", null, \"\\u5982\\u679C\\u9700\\u8981\\u653E\\u5165\\u7684\\u4F4D\\u7F6E\\u6B63\\u597D\\u6709\\u5176\\u4ED6\\u7EC4\\u4EF6\\uFF0C\\u90A3\\u4E48\\u8981\\u6839\\u636E\\u5F53\\u524D\\u62D6\\u62FD\\u7684\\u4F4D\\u7F6E\\u5728\\u8BE5\\u7EC4\\u4EF6\\u7684\\u4E0A/\\u4E0B\\u534A\\u90E8\\u5206\\u800C\\u5B9A\\uFF0C\\u4E0A\\u534A\\u90E8\\u5206\\u5C31\\u63D2\\u5728\\u524D\\u9762\\uFF0C\\u4E0B\\u534A\\u90E8\\u5206\\u5C31\\u63D2\\u5728\\u540E\\u9762\\u3002\"), mdx(\"p\", null, \"\\u5982\\u679C\\u662F\\u5DF2\\u7ECF\\u751F\\u6210\\u4E86\\u5BF9\\u5E94\\u7EC4\\u4EF6\\u4F46\\u9F20\\u6807\\u4E00\\u76F4\\u672A\\u91CA\\u653E\\uFF0C\\u6B64\\u65F6\\u5C31\\u8981\\u79FB\\u52A8\\u539F\\u6765\\u751F\\u6210\\u7684\\u7EC4\\u4EF6\\u5230\\u5F53\\u524D\\u4F4D\\u7F6E\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"let [y, h, curIndex] = [\\n  e.offsetY,\\n  e.target.offsetHeight,\\n  +e.target.dataset.index,\\n]\\n\\n// \\u9F20\\u6807\\u6240\\u5904\\u5728\\u5143\\u7D20\\u7684\\u4F4D\\u7F6E\\uFF0C\\u51B3\\u5B9A\\u7EC4\\u4EF6\\u91CA\\u653E\\u5728\\u5F53\\u524D\\u5143\\u7D20\\u7684\\u4E0A\\u4E0B\\u65B9\\nlet direction = y < h / 2\\nif (!hasPush.value) {\\n  // \\u7B2C\\u4E00\\u6B21\\u63D2\\u5165\\n  if (direction) {\\n    views.value.splice(curIndex, 0, defaultData)\\n  } else {\\n    curIndex += 1\\n    views.value.splice(curIndex, 0, defaultData)\\n  }\\n} else {\\n  // moving\\n  let i\\n  if (direction) {\\n    i = curIndex === 0 ? 0 : curIndex - 1\\n  } else {\\n    i = curIndex + 1\\n  }\\n\\n  // \\u62D6\\u62FD\\u4F4D\\u7F6E\\u6B63\\u597D\\u662F\\u539F\\u5148\\u8981\\u653E\\u5165\\u7684\\u4F4D\\u7F6E\\n  if (i < views.value.length && views.value[i].status === 2) return\\n\\n  const blockData = views.value.splice(draggingViewIndex.value, 1)\\n  views.value.splice(curIndex, 0, blockData[0])\\n}\\n\\ndraggingViewIndex.value = curIndex\\nhasPush.value = true\\n\")), mdx(\"h5\", null, \"\\u62D6\\u62FD\\u7ED3\\u675F\\uFF0C\\u91CA\\u653E\\u9F20\\u6807 \", mdx(\"inlineCode\", {\n    parentName: \"h5\"\n  }, \"drop\"), \" & \", mdx(\"inlineCode\", {\n    parentName: \"h5\"\n  }, \"dragend\")), mdx(\"p\", null, \"\\u76F8\\u5173\\u72B6\\u6001\\u590D\\u4F4D\\uFF0C\\u4EE5\\u53CA\\u5C06\\u65B0\\u751F\\u6210\\u7684\\u7EC4\\u4EF6\\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"status\"), \" \\u4FEE\\u6539\\u4E3A 1 \\u8868\\u793A\\u53EF\\u4EE5\\u6E32\\u67D3\\u89C6\\u56FE\\uFF08\\u6B64\\u524D\\u6E32\\u67D3\\u7684\\u662F\\u5360\\u4F4D\\u7528\\u7684\\uFF09\\u3002\"), mdx(\"h5\", null, \"\\u89C6\\u56FE\\u5BB9\\u5668\\u5185\\u7684\\u7EC4\\u4EF6\\u62D6\\u62FD\\u6392\\u5E8F\"), mdx(\"p\", null, \"\\u4F7F\\u7528 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vuedraggable\"), \" \\u5B9E\\u73B0\\u3002\"), mdx(\"h4\", null, \"\\u914D\\u7F6E\\u7EC4\\u4EF6\\u6570\\u636E\"), mdx(\"p\", null, \"\\u89C6\\u56FE\\u5185\\u7684\\u7EC4\\u4EF6\\u6570\\u636E\\u683C\\u5F0F\\u5982\\u4E0B\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"[\\n  {\\n    type: \\\"header\\\",\\n    options: {\\n      title: '\\u9875\\u9762\\u6807\\u9898', \\n      desc: '', \\n      backgroundColor: '#f8f8f8', \\n      bottomTabsEnable: true,\\n      bottomTabsData: [\\n        {\\n          id: 1649153768776,\\n          link: \\\"\\\", // \\u8DF3\\u8F6C\\u5730\\u5740\\n          name: \\\"\\u83DC\\u5355\\\",\\n          url: \\\"\\\" // \\u56FE\\u7247\\u5730\\u5740\\n        }\\n      ]\\n    },\\n  },\\n  {\\n    id: 1649153748781, // \\u7EC4\\u4EF6\\u6807\\u8BC6\\uFF0C\\u4EE5\\u9632\\u4F7F\\u7528\\u591A\\u4E2A\\u540C\\u7C7B\\u578B\\u7EC4\\u4EF6\\n    type: \\\"tab\\\",\\n    options: { // \\u6837\\u5F0F\\u7B49\\u53C2\\u6570\\u8BBE\\u7F6E\\n      themeColor: '#409eff'\\n    },\\n    data: [ // \\u6570\\u636E\\u6E90\\n      {id: 1, title: '\\u63A8\\u8350', link: ''},\\n      {id: 2, title: '\\u641C\\u7D22', link: ''},\\n      {id: 3, title: '\\u6211\\u7684', link: ''},\\n    ],\\n    status: 1,\\n  },\\n  {\\n    id: ,\\n    type: \\\"banner\\\",\\n    data: [\\n        {\\n            id: 1649154143475, \\n            name: 'banner1.jpeg', \\n            link: '', // \\u8DF3\\u8F6C\\u5730\\u5740\\n            url: '', // \\u56FE\\u7247\\u5730\\u5740\\n        },\\n        {\\n        {\\n            id: 1649154143477, \\n            name: 'banner2.jpeg', \\n            link: '', // \\u8DF3\\u8F6C\\u5730\\u5740\\n            url: '' // \\u56FE\\u7247\\u5730\\u5740\\n      }\\n    ],\\n    options: { // \\u6837\\u5F0F\\u7B49\\u53C2\\u6570\\u8BBE\\u7F6E\\n      indicatorType: \\\"rect\\\"\\n    }\\n  }\\n]\\n\")), mdx(\"p\", null, \"\\u8FD9\\u4EFD\\u6570\\u636E\\u9700\\u8981\\u4F20\\u5165\\u4E2D\\u95F4\\u7684\\u89C6\\u56FE\\u9884\\u89C8\\u7EC4\\u4EF6\\u548C\\u53F3\\u4FA7\\u7684\\u9762\\u677F\\u53C2\\u6570\\u914D\\u7F6E\\u7EC4\\u4EF6\\u3002\"), mdx(\"p\", null, \"\\u4F7F\\u7528Vue\\u63D0\\u4F9B\\u7684\\u52A8\\u6001\\u7EC4\\u4EF6 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"<component is=\\\"\\\" />\"), \" \\u6765\\u6E32\\u67D3\\u5BF9\\u5E94\\u7684\\u9762\\u677F\\u7EC4\\u4EF6\\u3002\"), mdx(\"p\", null, \"\\u6838\\u5FC3\\u7684\\u601D\\u8DEF\\u603B\\u7ED3\\u5B8C\\u6BD5\\uFF0C\\u4F46\\u76EE\\u524D\\u53EA\\u5904\\u7406\\u4E86\\u4E00\\u4E2A\\u9875\\u9762\\u7684\\u62D6\\u62FD\\u5E03\\u5C40\\uFF0C\\u540E\\u7EED\\u5F85\\u5230\\u65F6\\u95F4\\u5145\\u88D5\\u65F6\\u8FD8\\u9700\\u8981\\u6DFB\\u52A0\\u591A\\u4E2A\\u9875\\u9762\\uFF0C\\u5B9E\\u73B0\\u9875\\u9762\\u95F4\\u7684\\u5BFC\\u822A\\u3002\"));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"date":"2022-04-05 15:52:30","title":"可视化拖拽（小程序）布局编辑器","slug":"/blog/visual-layout-ui"}}},"pageContext":{"slug":"/blog/visual-layout-ui","next":"/blog/vue-image-processor","previous":"/blog/frontend-file-preview"}},"staticQueryHashes":[]}